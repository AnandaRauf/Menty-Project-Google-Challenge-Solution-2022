<html>
<head>
<script>

	alert("Welcome to Medison(Menty Disease Detection)");

</script>

<meta name="author" content="Ananda Rauf Maududi,Hars Sharma"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta http-equiv="Content-Type" content="HTML,CSS,JAVASCRIPT; charset=utf-8"/>
<meta name="keywords" content="html,css,js" />
<meta name=keywords" content="Menty,menty,mently healhty,Mently Healthy,Disease Detection,Personal Assistant, personal assistant,disease detection,disease"/>
<meta name="description" content="Menty Mently Healthy projects Personal Assistant and Disease Detection" />
<link rel="canonical" href="http://mentlyhealthy.000webhostapp.com/"/>
<link rel="stylesheet" href="css/index.css" type="text/css"/>
<link rel="icon" href="asset/favicon.ico" type="image/x-icon"/>
<!-- Google font -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap"
      rel="stylesheet"
    />

</head>
<title>Menty - Medison(Menty Disease Detection)</title>

<body>
<script>
    // disable right click
    document.addEventListener('contextmenu', event => event.preventDefault());

    document.onkeydown = function (e) {

        // disable F12 key
        if(e.keyCode == 123) {
            return false;
        }

        // disable I key
        if(e.ctrlKey && e.shiftKey && e.keyCode == 73){
            return false;
        }

        // disable J key
        if(e.ctrlKey && e.shiftKey && e.keyCode == 74) {
            return false;
        }

        // disable U key
        if(e.ctrlKey && e.keyCode == 85) {
            return false;
        }
    }

</script>
	<script src="js/index.js"></script>
	<!-- <iframe src="https://teachablemachine.withgoogle.com/models/XM2Ie5TdV/"></iframe> -->
	<main>
	<h1 class="title_h1">Medison(Menty Disease Detection)</h1>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
  <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
<center>
    <img id='idImage' align="center">
    </center>
    <labels id="label-disease">Your Object %</labels>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script> 
	<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script> 
   
  <section class="file-section">
    <div class="file-group">
      <label for="file-input">Upload Picture</label>
      <input type="file" id="file-input" accept="image/*" name="image" onchange="showFiles(event)"  onclick="init()" style="display: none;">
      

      
      	
      
    </div>
  </section>
  <br>
  <a href="https://teachablemachine.withgoogle.com/models/XM2Ie5TdV/"><button>Visit Cloud data model trained Teachable Machine</button></a>
</main>

	
<script type="text/javascript">
//import * as tf from '@tensorflow/tfjs';
	//let classifier;
  // Model URL
  //let imageModelURL = './my_model/';
  //let GettingPicture;
  //let flippedPicture;
  //let label = "";
  //let labelsdata;
 
  // Load the model first
  
  //function preload() {
    //classifier = ml5.imageClassifier(imageModelURL + 'datamodel/model.json');
  //}




	function showFiles() {
    // An empty img element
    
    let demoImage = document.getElementById('idImage');
    // read the file from the user
    let file = document.querySelector('input[type=file]').files[0];
    const reader = new FileReader();
    reader.onload = function (event) {
        demoImage.src = reader.result;
    }
    reader.readAsDataURL(file);
    //classifyPicture(demoImage.src);
   // init()
}  

//function setup() {
    //createCanvas(800, 800);
    // Create the Picture
    
    //GettingPicture = showFiles();
    //GettingPicture.size(800, 800);
    //GettingPicture.hide();

    //flippedPicture = GettingPicture;
    // Start classifying
    //classifyPicture();
  //}
//function draw() {
    //background(0);
    // Draw the Picture
    //image(flippedPicture, 0, 0);

    // Draw the label
  //  fill(255);
//    textSize(16);
   // textAlign(CENTER);
//    text(label, width / 2, height - 4);
  //}
//function classifyPicture() {
    //flippedPicture = GettingPicture;
    //classifier.classify(gotResult);
    
    //flippedPicture.remove();

 // }
  
  // When we get a result
  //function gotResult(error, results) {
    // If there is an error
    //if (error) {
      //console.error(error);
      //return;
    //}
    // The results are in an array ordered by confidence.
    // console.log(results[0]);
    //label = results[0].label;
    
    // Classifiy again!
    //classifyPicture();
  //}



const URL = "./my_model/";
let model,labelDisease, maxPredictions;
// Load the image model and setup the Image Canvas

    async function init() {
        const modelURL = URL + "http://mentlyhealthy.000webhostapp.com/medison/datamodel/model.json";
        const metadataURL = URL + "http://mentlyhealthy.000webhostapp.com/medison/datamodel/metadata.json";
        
        Image = document.getElementById('idImage'); //new tmImage.loadFromFiles(showFiles(event)) 
        let filessss = document.querySelector('input[type=file]').files[0];
        const readers = new FileReader();
        
        readers.onload = function (event) {
        
        Image.src = readers.result;
        
        }
        
       
        
        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // or files from your local hard drive
        // Note: the pose library adds "tmImage" object to your window (window.tmImage)
        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();
        labelDisease = document.getElementById("label-disease");
        
        for (let i = 0; i < maxPredictions; i++) { // and class labels
        
        readerss.readAsDataURL(filessss).appendChild(Image.canvas); 
        
        labelDisease.appendChild(document.createElement("label"));
        }
    }
    
    // run the webcam image through the image model
    
    async function predict() {
     
        // predict can take in an image, video or canvas html element
        
        //const modelss = await tf.loadLayersModel('http://mentlyhealthy.000webhostapp.com/medison/datamodel/model//.json');
         //let ShowImage= document.querySelector('input[type=file]').files[0]; 
         //const startpredict = tf.fromPixels(showFiles(event)); 
        const prediction = await model.predict(Image.canvas);
        
        for (let i = 0; i < maxPredictions; i++) {
            
            const classPrediction = prediction[i].className + ": " + prediction[i].probability.toFixed(2);
            labelDisease.childNodes[i].innerHTML = classPrediction;
        }
        
    } 
 
  </script> 

</body>
</html>
